<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="creatorMapper">

	<resultMap id="creatorResultSet" type="Creator">
		<id property="creNum" column="cre_num"/>
		<result property="memNum" column="mem_num"/>
		<result property="introduction" column="introduction"/>
		<result property="career" column="career"/>
		<result property="education" column="education"/>
		<result property="certification" column="certification"/>
		<result property="creStatus" column="cre_status"/>	
	</resultMap>
	
	<resultMap id="creatorAttachmentResultSet" type="CreatorAttachment">
		<id property="craNum" column="cre_num"/>
		<result property="creNum" column="cre_num" />
		<result property="craOname" column="cra_oname" />
		<result property="craRname" column="cra_rname" />
		<result property="craLevel" column="cra_Level" />
		<result property="craPath" column="cra_Path" />
	</resultMap>
	
	<resultMap id="signleCreatorResultSet" type="Creator">
		<id property="creNum" column="cre_num"/>
		<result property="memNum" column="mem_num"/>
		<result property="mem_NickName" column="mem_nick_name"/>
		<result property="introduction" column="introduction"/>
		<result property="career" column="career"/>
		<result property="education" column="education"/>
		<result property="certification" column="certification"/>
		<result property="creStatus" column="cre_status"/>	
	</resultMap>

	<select id="selectCreator" parameterType="_int" resultMap="creatorResultSet">
		select *
		from creator 
		where mem_num=#{memNum}
	</select>

	<select id="selectCreNum" parameterType="_int" resultType="_int">
		select cre_num 
		from creator
		where mem_num=#{memNum}
	</select>

	<insert id="insertCreator" parameterType="Creator">
		insert into creator 
		values(creator_seq.nextval, #{memNum}, #{introduction}, #{career}, #{education}, #{certification}, default)
	</insert>

	<insert id="insertProfile" parameterType="CreatorAttachment">
		insert into creator_attachment 
		values(creator_attachment_seq.nextval, #{creNum}, #{craOname}, #{craRname}, 0, #{craPath})
	</insert>

	<insert id="insertID" parameterType="CreatorAttachment">
		insert into creator_attachment
		values(creator_attachment_seq.nextval, #{creNum}, #{craOname}, #{craRname}, 1, #{craPath})
	</insert>
	
	<select id="selectCreatorCourse" parameterType="_int" resultMap="creatorResultSet">
		select *
		from creator
		join course using(cre_num)
		where course_num = #{courseNum}
	</select>
	
	<select id="selectCreatorAttachmentList" parameterType="_int" resultMap="creatorAttachmentResultSet">
		select *
		from creator_attachment
		where cre_num = #{creNum} and cra_level = 1
	</select>
	
	<select id="awaitSelectList" resultMap="singleCreatorResultSet">
		select *
		from creator
		join member using(mem_num)
		where cre_approved = 'N'
	</select>
	
	<update id="allowCreator" parameterType="_int">
		update creator
		set approved_date=sysdate, cre_status='Y'
		where cre_num = #{creNum}
	</update>
	
	<update id="rejectCreator" parameterType="_int">
		update course
		set approved_date=sysdate, cre_status='R'
		where cre_num = #{creNum}
	</update>
	
	<select id="creSelectList" resultMap="singleCreatorResultSet">
		select *
		from creator
		join member using(mem_num)
		where cre_approved = 'Y'
	</select>


</mapper>